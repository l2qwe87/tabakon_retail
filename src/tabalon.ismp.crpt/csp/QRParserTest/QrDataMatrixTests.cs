using System;
using TbkIsmpCrptApi;
using TbkIsmpCrptApi.Controllers;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace QRParserTest
{
    [TestClass]
    public class QrDataMatrixTests
    {
        [DataTestMethod]
        [DataRow("010541462278007621CimGms8C9swPomtz", "010541462278007621CimGms8C9swPomtz")]
        [DataRow("0104640030090754210001%ix800515000093vRdW", "0104640030090754210001%ix")]
        [DataRow("010290005275769421a?RI7ZL93X9NA", "010290005275769421a?RI7ZL")]
        [DataRow("00000046198488X?io+qCABm8wAYa", "00000046198488X?io+qC")]
        [DataRow("04640030090709DYBLHiyACoA", "04640030090709DYBLHiy")]
        [DataRow("010468012799555521fGHwsVi", "010468012799555521fGHwsVi")]
        [DataRow("(01)04680127995555(21)fGHwsVi", "010468012799555521fGHwsVi")]
        [DataRow("01230000211093s)pTKjQAAAAHwvf", "01230000211093s)pTKjQ")]
        [DataRow("010600179201211421LABtf,B 93gJWU", "010600179201211421LABtf,B")]
        [DataRow("0104610171993320215p1_;991EE1192X8V/aCSsDZi/lovrHG2WTCtGm/WWSmShyvA/9n5nSWE=", "0104610171993320215p1_;9")]
        [DataRow("0104610484027835215dm)oCPgCHOHf91EE1192fXOBGL899aDHWkarCAk4ZZZ5cyDdHcWsjxR7ewwr+dE=", "0104610484027835215dm)oCPgCHOHf")]
        [DataRow("0104610484027835215T7Y*RccvqX/G91EE1192nsBf/xd95nbABF2n0cDXOlK1Fh9+lZzgoUDZ5SF+dzo=", "0104610484027835215T7Y*RccvqX/G")]
        [DataRow("010460165303918621GbEXjF?8005170000", "010460165303918621GbEXjF?")]
        public void GetCIS(string qr, string cis)
        {
            var qrPa = new QRParser(qr);
            Assert.AreEqual(cis, qrPa.CIS);
        }

        // Full string CIS tests - QR codes that should return the complete string as CIS
        [DataTestMethod]
        [DataRow("010400639605740221RU11121825238122948", "010400639605740221RU11121825238122948")]
        [DataRow("010401292285156721RU13120125254185826", "010401292285156721RU13120125254185826")]
        [DataRow("010401292285156721RU13120125254190100", "010401292285156721RU13120125254190100")]
        [DataRow("010401292285159821RU13120125258122201", "010401292285159821RU13120125258122201")]
        [DataRow("010400639609867221RU11120525254003658", "010400639609867221RU11120525254003658")]
        [DataRow("010400639609867221RU11120525254024842", "010400639609867221RU11120525254024842")]
        [DataRow("010400639609867221RU11120525254030141", "010400639609867221RU11120525254030141")]
        [DataRow("010401292285163521RU13120225293130844", "010401292285163521RU13120225293130844")]
        [DataRow("010401292285163521RU13120225293131224", "010401292285163521RU13120225293131224")]
        [DataRow("010401292285163521RU13120225293131337", "010401292285163521RU13120225293131337")]
        public void GetCISFullString(string qr, string expectedCis)
        {
            var qrPa = new QRParser(qr);
            Assert.AreEqual(expectedCis, qrPa.CIS);
        }

        // ClothesCIS converted to DataTestMethod with DataRow
        [DataTestMethod]
        [DataRow("0104610541730272215pnKT'RwId);*91EE1192PFY/37fDDABcSYnthTvZ9i90lB04JHGgCGsBDGie0uM=", "0104610541730272215pnKT'RwId);*")]
        public void ClothesCIS(string qr, string expected)
        {
            var qrPa = new QRParser(qr);
            Assert.AreEqual(expected, qrPa.CIS);
        }
    }
}
